<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <script type="text/javascript">var _sf_startpt=(new Date()).getTime()</script>
    <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
    <meta content="The online musing of Brendon Murphy" name="description" />
    <link href="/favicon.ico" rel="shortcut icon" type="image/x-icon" />
    <link href="/css/screen.css" media="screen, projection" rel="stylesheet" type="text/css" />
    <link href="/css/pygment_trac.css" media="screen, projection" rel="stylesheet" type="text/css" />
    <link rel="alternate" type="application/atom+xml" title="Brendon Murphy - Atom" href="http://feeds.feedburner.com/techfreaknet" />
    <title>Brendon Murphy &ndash; techfreak.net</title>
  </head>
  <body>
    <header>
    <h1 id="title">
      <a href="/about.html" title="About">Brendon Murphy</a> writes <a href="/" title="Home">here</a>.
    </h1>
    <h2 id="subtitle">
      See also the <a href="/archive.html" title="Archive">archive</a> &amp;
      <a href="/miscellaneous.html">miscellaneous</a>.
    </h2>
    </header>
    <sidebar id="sidebar">

      <div id="sidebar-about" class="sidebar-item">
        <p>My experience runs from unix & linux system administration, to programming for the web.  I'm a firm believer in open source, and spend much of my time these days in Ruby.</p>

        <p>My passions include git, github, rspec, rails, jQuery, programming in general, and my girlfriend Arielle.</p>

        <p>I like to hang out with other Ruby-ists in Orange County.  You can connect with us at the monthly <a href="http://www.meetup.com/ocruby/">OC Ruby Users Group</a>.  We'd love to see you there.</p>
      </div>

      <div id="working-with-rails" class="sidebar-item">
        WorkingWithRails is the online home of the world's community of Ruby on Rails users. Go <a href="http://workingwithrails.com/person/19061-brendon-murphy">check my profile there.</a>
      </div>

      <div class="sidebar-item" id="social">
        <a href="http://feeds.feedburner.com/Techfreaknet" rel="alternate" type="application/rss+xml"><img src="http://www.feedburner.com/fb/images/pub/feed-icon32x32.png" alt="" style="vertical-align:middle;border:0"/></a>&nbsp;<a href="http://feeds.feedburner.com/Techfreaknet" class="center" rel="alternate" type="application/rss+xml">Subscribe to my feed</a>

        <a href="http://twitter.com/xternal"><img src="/images/t_logo-b32x32.png" alt="" style="vertical-align:middle;border:0"/></a>&nbsp;<a href="http://twitter.com/xternal" class="center" rel="alternate">Follow me on Twitter</a>

        <div id="tweet">
          <p>Please wait while my tweets load <img src="/images/indicator.gif" /></p>
          <p><a href="http://twitter.com/xternal">If you can't wait - check out what I've been twittering</a></p>
        </div>
      </div>

      <div class="sidebar-item" id="goodreads">
        <div id="currently_reading">Currently Reading</div>
        <style type="text/css" media="screen">
          .gr_grid_container { /* customize grid container div here. eg: width: 500px; */ } 
          .gr_grid_book_container { /* customize book cover container div here */ 
            float: left; 
            width: 39px; 
            height: 60px; 
            padding: 0px 0px;
            overflow: hidden; 
          }
        </style>
        <div id="gr_grid_widget_1311841551">
          <!-- Show static html as a placeholder in case js is not enabled - javascript include will override this if things work -->

          <div class="gr_grid_container">
          </div>
          }
        </div>
        <script src="http://www.goodreads.com/review/grid_widget/2728801.Brendon's%20currently-reading%20book%20montage?cover_size=small&amp;hide_link=true&amp;hide_title=true&amp;num_books=12&amp;order=d&amp;shelf=currently-reading&amp;sort=date_added&amp;widget_id=1311841551" type="text/javascript" charset="utf-8"></script>

        <div id="recently_read">Recently Read</div>
        <style type="text/css" media="screen">
          .gr_grid_container { /* customize grid container div here. eg: width: 500px; */ } 
          .gr_grid_book_container { /* customize book cover container div here */ 
            float: left; 
            width: 39px; 
            height: 60px; 
            padding: 0px 0px;
            overflow: hidden; 
          }
        </style>
        <div id="gr_grid_widget_1311841495">
          <!-- Show static html as a placeholder in case js is not enabled - javascript include will override this if things work -->

          <div class="gr_grid_container">
          </div>
          }
        </div>
        <script src="http://www.goodreads.com/review/grid_widget/2728801.Brendon's%20read%20book%20montage?cover_size=small&amp;hide_link=false&amp;hide_title=true&amp;num_books=12&amp;order=d&amp;shelf=read&amp;sort=date_added&amp;widget_id=1311841495" type="text/javascript" charset="utf-8"></script>
      </div>

    </sidebar>

    <div id="wrapper">
      
<div class="post">  

  <h1>
    NotNot Alternative
  </h1>

  <p>There&#8217;s a common ruby convention out there, I call it NotNot.  You&#8217;ll find it often in predicate methods, and it looks like it sounds, &#8216;!!&#8217;.  I suppose you could call it &#8220;Bang Bang&#8221;, or perhaps it has a real name I&#8217;m not aware of.</p>
<p>I don&#8217;t like NotNot, primarily I think because in my head it seems like the dreaded English grammar double negative.  In other words, it&#8217;s just weird.</p>
<p>The point of the NotNot is for your classes to return true/false, rather than just truthy/falsy.  Let&#8217;s start with a simple example predicate:</p>
<script src="https://gist.github.com/1109678.js?file=first_example.rb"></script><p>What?  That looks kind of strange, however, it will pass conditional tests, since ruby treats the values nil and false both as falsy values, while other values as truthy.  But again, the returns look weird.  Enter the NotNot:</p>
<script src="https://gist.github.com/1109678.js?file=second_example.rb"></script><p>Hey, those returns looks better, I see we&#8217;re getting back real true/false which is really what we want.  But that NotNot looks weird.  Think about it in your head, what&#8217;s the value of not not false&#8230;uh.</p>
<p>Say hello to the TrueClass#&amp; method.  The <a href="http://www.ruby-doc.org/core/classes/TrueClass.html#M000564">TrueClass RDoc states</a> that the &amp; method &#8220;Returns false if obj is nil or false, true otherwise.&#8221;</p>
<script src="https://gist.github.com/1109678.js?file=third_example.rb"></script><p>You&#8217;ll note we&#8217;re still getting back true/false.  The method is less terse than the NotNot, but I think slightly a better match intuitively.</p>
<p>In the end, it really boils down to style and readability.  If you code Ruby, while it&#8217;s important to know the NotNot, I&#8217;d advise something your brain doesn&#8217;t have to double unroll.</p>
<p>Hat tip to my friend <a href="http://www.billpratt.net/">Bill</a> for taking me straight from example 1 to 3 when I started in Ruby.</p>  
  
  <p class="signoff">
    &mdash;<a href="/programming,/ruby/2011/07/27/notnot-alternative.html">Jul 27, 2011</a>
  </p>

  <p class="index_comments_count"><a href="/programming,/ruby/2011/07/27/notnot-alternative.html#disqus_thread">/programming,/ruby/2011/07/27/notnot-alternative.html comments</a></p>
  </div>

<div class="post">  

  <h1>
    Onward to Jekyll
  </h1>

  <p>In the grand tradition of getting bored with blogging software, without actually taking the time to blog, I&#8217;ve transitioned software yet again.  This time I selected <a href="http://github.com/mojombo/jekyll">Jekyll</a> to try.  I discovered that in the past I&#8217;ve had a habit of writing blog posts in TextMate or Vim, and then pasting them into whatever blog software I was using at the time.  That&#8217;s silly.  Now I can just edit in my editor of choice, have full <em>syntax aware</em> access to template and <span class="caps">CSS</span> documents without dealing with a nasty web interface, and have greater flexibility for throwing different pages up on the site.  With blog software, it&#8217;s often like pulling teeth when you want those pages that are more <span class="caps">CMS</span> than blog.  Not so with Jekyll.  It&#8217;s a template system that simply builds a static site out of layout and markup files (I&#8217;m using textile).  When you want that one-off page, all you have to do is drop it in.  There&#8217;s no requirement that it play nice with the rest of your site, it could truly be a one-off if you so desired.</p>
<p>Anyway, if you want some fun and simple software to test-drive, I&#8217;d recommend it.  Not that it&#8217;ll get me to post any more.  Or perhaps, it will.</p>  
  
  <p class="signoff">
    &mdash;<a href="/2010/09/08/onward-to-jekyll.html">Sep 08, 2010</a>
  </p>

  <p class="index_comments_count"><a href="/2010/09/08/onward-to-jekyll.html#disqus_thread">/2010/09/08/onward-to-jekyll.html comments</a></p>
  </div>

<div class="post">  

  <h1>
    Metaprogramming in Ruby: Part 1
  </h1>

  <p>I joked with a co-worker the other day that, sometimes I think I&#8217;m better at Ruby metaprogramming that straight ahead programming.  This is a serious exaggeration, and I don&#8217;t count myself as an expert at either.  However, it dawned on me that, I have a few friends that aren&#8217;t as exposed to metaprogramming concepts in Ruby, so, what better topic to share about.  Hopefully in the process, you&#8217;ll learn something new, and, I&#8217;ll become better at explaining Ruby concepts and sharing code.</p>
<p>Before I dive in with some introductory examples, a quick definition of metaprogramming is in order.  To quote <a href="http://en.wikipedia.org/wiki/Metaprogramming" title="Wikipedia">Wikipedia</a>, &#8220;Metaprogramming is the writing of computer programs that write or manipulate other programs (or themselves) as their data, or that do part of the work at compile time that would otherwise be done at runtime&#8221;.  If you use Rails (and, I know you do), metaprogramming enables things you already do on a daily basis, such as dynamic find_by methods in ActiveRecord, or plugins that dynamically get a class to include them (acts_as_list, acts_as_tree, etc).</p>
<p>In this writeup, I&#8217;ll start with two extremely basic metaprogramming concepts.  In fact, these might not even be considered true Ruby metaprogramming, but, I wanted to start with some simple ideas which you may not have been exposed to in Ruby 101.</p>
<p>The first concept to get down in Ruby is that, classes are objects like anything else.  In Ruby, this means you can open the class and modify it on the fly.  The practice is affectionately called monkey patching or duck punching.  Let&#8217;s look at a simple example:</p>
<script src="http://gist.github.com/222706.js"></script><p>You can see above, we&#8217;ve created a Foo class with a public instance method, bar.  Calling foo.bar, we&#8217;ll get the output we expect, &#8220;bar!&#8221;.  Next, we reopen the Foo class, and add a new public instance method, foobar.  Had we tried to use Foo#foobar before this, we&#8217;d get a NoMethodError exception, as expected.  However, having reopened and modified the class, we can call our new method.</p>
<p>The other demonstration I&#8217;d like to show is one way you can define methods on the fly.  This example is abstract and doesn&#8217;t represent a recommended use, it&#8217;s simply to prove the point.</p>
<script src="http://gist.github.com/222724.js"></script><p>Running this simple example, the first call to foo_two.bar will output &#8220;bar&#8221;.  However, once we call foo.cap_bar, the public instance method bar is changed.  Running it a second time will output &#8220;<span class="caps">BAR</span>!!!&#8221;.  A more common, rubyish way of defining methods at run time in Ruby is the use of <a href="http://ruby-doc.org/core/classes/Module.html#M001654" title="define_method">define_method</a>, which I&#8217;ll cover in a future post.</p>
<p>An important concept to keep in mind here is that, you aren&#8217;t modifying behavior solely on the foo or foo_two instances.  Instead, you are changing the behavior of any open instance of the Foo or FooTwo classes.  So in our FooTwo example, if you were to create a foo_too instance, calling foo_too.bar would run through the dynamically created method as well and output &#8220;<span class="caps">BAR</span>!!!&#8221;.  In future postings, we&#8217;ll see a different approach of opening instances and defining methods specific to that instance.</p>
<p>Hopefully this has whet your appetite a little, and, in the future, we can run through some more exciting examples of the metaprogramming facilities Ruby has to offer.</p>  
  
  <p class="signoff">
    &mdash;<a href="/2009/10/30/metaprogramming-in-ruby-part-1.html">Oct 30, 2009</a>
  </p>

  <p class="index_comments_count"><a href="/2009/10/30/metaprogramming-in-ruby-part-1.html#disqus_thread">/2009/10/30/metaprogramming-in-ruby-part-1.html comments</a></p>
  </div>

<div class="post">  

  <h1>
    wp-syntax test
  </h1>

  <p>Just testing out wp-syntax highlighting, and demoing it for some friends.  Colorful ruby code!</p>
<div class="highlight"><pre><code class="ruby"><span class="nb">require</span> <span class="s2">&quot;date&quot;</span>

<span class="k">class</span> <span class="nc">DateReformatter</span>
  <span class="kp">attr_reader</span> <span class="ss">:date</span>
  
  <span class="k">def</span> <span class="nf">initialize</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
    <span class="nb">self</span><span class="o">.</span><span class="n">date</span> <span class="o">=</span> <span class="n">date</span>
  <span class="k">end</span>
  
  <span class="k">def</span> <span class="nf">date</span><span class="o">=</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
    <span class="k">begin</span>
      <span class="vi">@date</span> <span class="o">=</span> <span class="no">DateTime</span><span class="o">::</span><span class="n">parse</span><span class="p">(</span><span class="n">date</span><span class="p">)</span>
    <span class="k">rescue</span>
      <span class="vi">@date</span> <span class="o">=</span> <span class="no">DateTime</span><span class="o">::</span><span class="n">now</span><span class="p">()</span>
    <span class="k">end</span>
  <span class="k">end</span>
  
  <span class="k">def</span> <span class="nf">reformat</span>
    <span class="n">local</span> <span class="o">=</span> <span class="no">DateTime</span><span class="o">.</span><span class="n">now</span><span class="p">()</span>
    <span class="n">utc</span> <span class="o">=</span> <span class="vi">@date</span><span class="o">.</span><span class="n">new_offset</span>
    <span class="n">local_from_utc</span> <span class="o">=</span> <span class="n">utc</span><span class="o">.</span><span class="n">new_offset</span><span class="p">(</span><span class="n">local</span><span class="o">.</span><span class="n">offset</span><span class="p">)</span>
    <span class="n">local_from_utc</span><span class="o">.</span><span class="n">to_s</span>
    <span class="s2">&quot;</span><span class="si">#{</span><span class="n">pad</span><span class="p">(</span><span class="n">local_from_utc</span><span class="o">.</span><span class="n">hour</span><span class="p">)</span><span class="si">}</span><span class="s2">:</span><span class="si">#{</span><span class="n">pad</span><span class="p">(</span><span class="n">local_from_utc</span><span class="o">.</span><span class="n">min</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
  <span class="k">end</span>
  
  <span class="kp">private</span>
  
  <span class="k">def</span> <span class="nf">pad</span><span class="p">(</span><span class="n">num</span><span class="p">)</span>
    <span class="n">num</span><span class="o">.</span><span class="n">to_s</span><span class="o">.</span><span class="n">rjust</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s1">&#39;0&#39;</span><span class="p">)</span>
  <span class="k">end</span>
<span class="k">end</span>
</code></pre>
</div>  
  
  <p class="signoff">
    &mdash;<a href="/2009/05/04/wp-syntax-test.html">May 04, 2009</a>
  </p>

  <p class="index_comments_count"><a href="/2009/05/04/wp-syntax-test.html#disqus_thread">/2009/05/04/wp-syntax-test.html comments</a></p>
  </div>

<div class="post">  

  <h1>
    Roll your own dropbox
  </h1>

  <p>So I&#8217;ve had occasion recently to send out some slightly large .zip files to friends.  The problem with doing this is, often the attachments end up too large for some mail server in the mix.  The typical way these days around the problem is to use some sort of dropbox web application.  Usually you upload your file to the dropbox site, and are presented with a link that you can email to your friend, which then allows them to download the file.  Check out <a href="http://www.filedropper.com/">filedropper.com</a> for a simple example of such an application.</p>
<p>Of course, I was bored, and don&#8217;t like the extra steps of having to archive my files to a zip, browse to a website, click upload, find the file I want, upload it, and delete the archive copy.  Granted, there are some quicker solutions out there, but again, I was bored.</p>
<p>So I came up with a tiny solution that costs a few pennies and was fun.  All you need is the OS X Automator program, a programming language of your choice (I picked <a href="http://www.ruby-lang.org/en/">ruby</a>) and a module for interfacing with <a href="http://aws.amazon.com/s3">Amazon&#8217;s S3 service</a>.</p>
<p>The procedure is simple.  If I have time, and clean up the code enough, I might post it here.  But here&#8217;s the basic workflow steps:</p>
<ol>
<li>Make an Automator workflow that takes a selected set of files (&#8220;Get Selected Items&#8221;) and creates an archive (&#8220;Create Archive&#8221;) out of them</li>
<li>Pass that archive into a script (&#8220;Run Shell Script&#8221;) to upload the file to S3.  Generate a filename for S3 by hashing some timestamp info, the filename, etc.</li>
<li>Store the file on S3, and then output the full S3 url for capture by Automator.</li>
<li>Use the Automator &#8220;New Mail Message&#8221; action, passing in the url as the content of the message</li>
<li>Plan on manually addressing the message, filling out the body if you like.</li>
<li>Now here&#8217;s what makes it convenient: save the workflow as an application.  Drag the saved application to the Dock.</li>
</ol>
<p>Now I have a droplet on the dock which I can drag any number of selected files to, which will upload to S3, and generate a new mail message with the download link in the message body.</p>
<p>I still need a scheduled job that cleans out old files from the bucket.  But the process is fairly easy, works great, and was fun to come up with.  Now I admit, for a small solution for use with friends, there&#8217;s really no reason to pick Amazon.  I could probably just as easily upload to my website, and link from there.  But hey, that&#8217;s not as &#8220;sexy&#8221;, right?</p>  
  
  <p class="signoff">
    &mdash;<a href="/2008/03/29/roll-your-own-dropbox.html">Mar 29, 2008</a>
  </p>

  <p class="index_comments_count"><a href="/2008/03/29/roll-your-own-dropbox.html#disqus_thread">/2008/03/29/roll-your-own-dropbox.html comments</a></p>
  </div>


      <footer id="footer">
      <a href="/" title="Home">Home</a> &bull;
      <a href="/about.html" title="About the author and site">About</a> &bull;
      <a href="/archive.html" title="Archived writing">Archive</a> &bull;
      <a href="/miscellaneous.html" title="Miscellaneous">Miscellaneous</a>

      <div id="cse" style="width: 100%;">Loading</div>
      <script src="http://www.google.com/jsapi" type="text/javascript"></script>
      <script type="text/javascript">
        google.load('search', '1', {language : 'en'});
        google.setOnLoadCallback(function() {
            var customSearchControl = new google.search.CustomSearchControl('003730570411629047560:hoyvw7xkswg');
            customSearchControl.setResultSetSize(google.search.Search.FILTERED_CSE_RESULTSET);
            customSearchControl.draw('cse');
            }, true);
</script>
<link rel="stylesheet" href="http://www.google.com/cse/style/look/minimalist.css" type="text/css" />
<style>
  .gsc-control-cse { padding-left: 0px; }
  .gsc-control-cse a:link, .gsc-control-cse a:hover { color: #336699; }
</style>
</footer>
    </div>
    <script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-15226195-1");
pageTracker._trackPageview();
} catch(err) {}</script>

    <script src="http://twitterjs.googlecode.com/svn/trunk/src/twitter.min.js" type="text/javascript"></script>
<script>
  getTwitters('tweet', { 
    id: 'xternal', 
    count: 2, 
    enableLinks: true, 
    ignoreReplies: true, 
    clearContents: true,
    template: '"%text%" <a href="http://twitter.com/%user_screen_name%/statuses/%id%/"><span class="time">&ndash;%time%</span></a>'
  });  
</script>

    <script type="text/javascript">
//<[CDATA[
(function() {
	var links = document.getElementsByTagName('a');
	var query = '?';
	for(var i = 0; i < links.length; i++) {
		if(links[i].href.indexOf('#disqus_thread') >= 0) {
			query += 'url' + i + '=' + encodeURIComponent(links[i].href) + '&';
		}
	}
	document.write('<script type="text/javascript" src="http://disqus.com/forums/techfreak/get_num_replies.js' + query + '"></' + 'script>');
	})();
//]]>
</script>

  </body>
</html>
